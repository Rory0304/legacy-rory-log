<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><link rel="stylesheet" href="/_next/static/css/b761462680944f45.css" data-precedence="next"/><link rel="preload" as="style" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.6/dist/web/static/pretendard.css" crossorigin=""/><link rel="icon" href="/favicon.ico"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" as="style" crossorigin="" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.6/dist/web/static/pretendard.css"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" noModule=""></script></head><style data-emotion="css-global o6gwfi">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%;}*,*::before,*::after{box-sizing:inherit;}strong,b{font-weight:700;}body{margin:0;color:rgba(0, 0, 0, 0.87);font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;background-color:#fff;}@media print{body{background-color:#fff;}}body::backdrop{background-color:#fff;}</style><style data-emotion="css-global 11wdu68">html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline;}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block;}body{line-height:1;}ol,ul{list-style:none;}blockquote,q{quotes:none;}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none;}table{border-collapse:collapse;border-spacing:0;}a{color:inherit;-webkit-text-decoration:none;text-decoration:none;}</style><body><style data-emotion="css rnw5k1">.css-rnw5k1{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;box-sizing:border-box;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;position:fixed;z-index:1100;top:0;left:auto;right:0;background-color:#FF7F50;color:#fff;border-radius:0;-webkit-transition:linear 0.2s;transition:linear 0.2s;-webkit-backdrop-filter:saturate(180%) blur(5px);backdrop-filter:saturate(180%) blur(5px);background:hsla(0,0%,100%,.8);box-shadow:inset 0 -1px 0 0 #eaeaea;}@media print{.css-rnw5k1{position:absolute;}}</style><style data-emotion="css doskks">.css-doskks{background-color:#fff;color:rgba(0, 0, 0, 0.87);-webkit-transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;box-shadow:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;box-sizing:border-box;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;position:fixed;z-index:1100;top:0;left:auto;right:0;background-color:#FF7F50;color:#fff;border-radius:0;-webkit-transition:linear 0.2s;transition:linear 0.2s;-webkit-backdrop-filter:saturate(180%) blur(5px);backdrop-filter:saturate(180%) blur(5px);background:hsla(0,0%,100%,.8);box-shadow:inset 0 -1px 0 0 #eaeaea;}@media print{.css-doskks{position:absolute;}}</style><header class="MuiPaper-root MuiPaper-elevation MuiPaper-elevation0 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionFixed mui-fixed css-doskks"><style data-emotion="css 1c0cfyw">.css-1c0cfyw{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;}@media (min-width:600px){.css-1c0cfyw{padding-left:24px;padding-right:24px;}}@media (min-width:900px){.css-1c0cfyw{max-width:900px;}}</style><div class="MuiContainer-root MuiContainer-maxWidthMd css-1c0cfyw"><style data-emotion="css 12o98wt">.css-12o98wt{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-height:56px;}@media (min-width:0px){@media (orientation: landscape){.css-12o98wt{min-height:48px;}}}@media (min-width:600px){.css-12o98wt{min-height:64px;}}</style><div class="MuiToolbar-root MuiToolbar-regular css-12o98wt"><style data-emotion="css jm54mf">.css-jm54mf{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="MuiBox-root css-jm54mf"><div class="MuiBox-root css-0"><a href="/"><style data-emotion="css yg89pu">.css-yg89pu{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;font-size:24px;font-weight:800;color:black;margin-top:16px;margin-bottom:16px;display:block;}</style><h1 class="MuiTypography-root MuiTypography-body1 css-yg89pu">RD</h1></a></div><style data-emotion="css 1h7fpw9">.css-1h7fpw9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;row-gap:8px;}</style><div class="MuiStack-root css-1h7fpw9"><a href="/"><style data-emotion="css v9t3dc">.css-v9t3dc{font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.875rem;line-height:1.75;letter-spacing:0.02857em;text-transform:uppercase;min-width:64px;padding:6px 8px;border-radius:4px;-webkit-transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:#64748B;margin-top:16px;margin-bottom:16px;display:block;color:black;text-transform:initial;}.css-v9t3dc:hover{-webkit-text-decoration:none;text-decoration:none;background-color:rgba(100, 116, 139, 0.04);}@media (hover: none){.css-v9t3dc:hover{background-color:transparent;}}.css-v9t3dc.Mui-disabled{color:rgba(0, 0, 0, 0.26);}</style><style data-emotion="css 1a7ghp1">.css-1a7ghp1{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.875rem;line-height:1.75;letter-spacing:0.02857em;text-transform:uppercase;min-width:64px;padding:6px 8px;border-radius:4px;-webkit-transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:#64748B;margin-top:16px;margin-bottom:16px;display:block;color:black;text-transform:initial;}.css-1a7ghp1::-moz-focus-inner{border-style:none;}.css-1a7ghp1.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-1a7ghp1{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-1a7ghp1:hover{-webkit-text-decoration:none;text-decoration:none;background-color:rgba(100, 116, 139, 0.04);}@media (hover: none){.css-1a7ghp1:hover{background-color:transparent;}}.css-1a7ghp1.Mui-disabled{color:rgba(0, 0, 0, 0.26);}</style><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textNeutral MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-root MuiButton-text MuiButton-textNeutral MuiButton-sizeMedium MuiButton-textSizeMedium css-1a7ghp1" tabindex="0" type="button">Articles</button></a><a href="/logs"><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textNeutral MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-root MuiButton-text MuiButton-textNeutral MuiButton-sizeMedium MuiButton-textSizeMedium css-1a7ghp1" tabindex="0" type="button">Logs</button></a><a href="/about"><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textNeutral MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-root MuiButton-text MuiButton-textNeutral MuiButton-sizeMedium MuiButton-textSizeMedium css-1a7ghp1" tabindex="0" type="button">About</button></a></div></div></div></div></header><main><style data-emotion="css 18kddpf">.css-18kddpf{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;padding-top:64px;padding-bottom:64px;}@media (min-width:600px){.css-18kddpf{padding-left:24px;padding-right:24px;}}@media (min-width:900px){.css-18kddpf{max-width:900px;}}</style><div class="MuiContainer-root MuiContainer-maxWidthMd css-18kddpf"><article class="article-template"><style data-emotion="css 1nd45d6">.css-1nd45d6{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;width:100%;height:385px;}</style><header class="MuiBox-root css-1nd45d6"><style data-emotion="css i6jgy2">.css-i6jgy2{width:100vw;height:100%;}</style><div class="MuiBox-root css-i6jgy2"><style data-emotion="css 57rd2i">.css-57rd2i{position:absolute;top:0;left:0;inset:0;height:385px;}</style><div class="MuiBox-root css-57rd2i"><img alt="Next 13 react hydration error 썸네일입니다." fetchPriority="high" decoding="async" data-nimg="fill" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;object-fit:cover;color:transparent" sizes="100vw" srcSet="/_next/image?url=https%3A%2F%2Fimages.ctfassets.net%2F98cksird3kze%2F1aSjwwZ9CchJJCAK8ED6ew%2F40539531bd28edceb0b5dfe40f9c9c66%2Fpexels-pixabay-327090.jpeg&amp;w=640&amp;q=75 640w, /_next/image?url=https%3A%2F%2Fimages.ctfassets.net%2F98cksird3kze%2F1aSjwwZ9CchJJCAK8ED6ew%2F40539531bd28edceb0b5dfe40f9c9c66%2Fpexels-pixabay-327090.jpeg&amp;w=750&amp;q=75 750w, /_next/image?url=https%3A%2F%2Fimages.ctfassets.net%2F98cksird3kze%2F1aSjwwZ9CchJJCAK8ED6ew%2F40539531bd28edceb0b5dfe40f9c9c66%2Fpexels-pixabay-327090.jpeg&amp;w=828&amp;q=75 828w, /_next/image?url=https%3A%2F%2Fimages.ctfassets.net%2F98cksird3kze%2F1aSjwwZ9CchJJCAK8ED6ew%2F40539531bd28edceb0b5dfe40f9c9c66%2Fpexels-pixabay-327090.jpeg&amp;w=1080&amp;q=75 1080w, /_next/image?url=https%3A%2F%2Fimages.ctfassets.net%2F98cksird3kze%2F1aSjwwZ9CchJJCAK8ED6ew%2F40539531bd28edceb0b5dfe40f9c9c66%2Fpexels-pixabay-327090.jpeg&amp;w=1200&amp;q=75 1200w, /_next/image?url=https%3A%2F%2Fimages.ctfassets.net%2F98cksird3kze%2F1aSjwwZ9CchJJCAK8ED6ew%2F40539531bd28edceb0b5dfe40f9c9c66%2Fpexels-pixabay-327090.jpeg&amp;w=1920&amp;q=75 1920w, /_next/image?url=https%3A%2F%2Fimages.ctfassets.net%2F98cksird3kze%2F1aSjwwZ9CchJJCAK8ED6ew%2F40539531bd28edceb0b5dfe40f9c9c66%2Fpexels-pixabay-327090.jpeg&amp;w=2048&amp;q=75 2048w, /_next/image?url=https%3A%2F%2Fimages.ctfassets.net%2F98cksird3kze%2F1aSjwwZ9CchJJCAK8ED6ew%2F40539531bd28edceb0b5dfe40f9c9c66%2Fpexels-pixabay-327090.jpeg&amp;w=3840&amp;q=75 3840w" src="/_next/image?url=https%3A%2F%2Fimages.ctfassets.net%2F98cksird3kze%2F1aSjwwZ9CchJJCAK8ED6ew%2F40539531bd28edceb0b5dfe40f9c9c66%2Fpexels-pixabay-327090.jpeg&amp;w=3840&amp;q=75"/></div></div></header><div class="MuiBox-root css-0"><style data-emotion="css hix1c1">.css-hix1c1{padding-bottom:32px;}</style><div class="MuiBox-root css-hix1c1"><style data-emotion="css 38x1e2">.css-38x1e2{max-width:100%;font-family:"Roboto","Helvetica","Arial",sans-serif;font-size:0.8125rem;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;height:32px;color:rgba(0, 0, 0, 0.87);background-color:rgba(0, 0, 0, 0.08);border-radius:16px;white-space:nowrap;-webkit-transition:background-color 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;cursor:default;outline:0;-webkit-text-decoration:none;text-decoration:none;border:0;padding:0;vertical-align:middle;box-sizing:border-box;border-radius:16px;margin-bottom:8px;}.css-38x1e2.Mui-disabled{opacity:0.38;pointer-events:none;}.css-38x1e2 .MuiChip-avatar{margin-left:5px;margin-right:-6px;width:24px;height:24px;color:#616161;font-size:0.75rem;}.css-38x1e2 .MuiChip-avatarColorPrimary{color:#fff;background-color:#FF7F50;}.css-38x1e2 .MuiChip-avatarColorSecondary{color:#fff;background-color:#7b1fa2;}.css-38x1e2 .MuiChip-avatarSmall{margin-left:4px;margin-right:-4px;width:18px;height:18px;font-size:0.625rem;}.css-38x1e2 .MuiChip-icon{margin-left:5px;margin-right:-6px;color:#616161;}.css-38x1e2 .MuiChip-deleteIcon{-webkit-tap-highlight-color:transparent;color:rgba(0, 0, 0, 0.26);font-size:22px;cursor:pointer;margin:0 5px 0 -6px;}.css-38x1e2 .MuiChip-deleteIcon:hover{color:rgba(0, 0, 0, 0.4);}</style><div class="MuiChip-root MuiChip-filled MuiChip-sizeMedium MuiChip-colorDefault MuiChip-filledDefault css-38x1e2"><style data-emotion="css 9iedg7">.css-9iedg7{overflow:hidden;text-overflow:ellipsis;padding-left:12px;padding-right:12px;white-space:nowrap;}</style><span class="MuiChip-label MuiChip-labelMedium css-9iedg7">Troubleshooting</span></div><style data-emotion="css 1kloaa2">.css-1kloaa2{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:2.125rem;line-height:1.235;letter-spacing:0.00735em;font-weight:800;margin-bottom:16px;}</style><h1 class="MuiTypography-root MuiTypography-h4 css-1kloaa2">Next 13 react hydration error</h1><style data-emotion="css 1shhv9g">.css-1shhv9g{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:0.75rem;line-height:1.66;letter-spacing:0.03333em;color:GrayText;}</style><span class="MuiTypography-root MuiTypography-caption css-1shhv9g"><time dateTime="2023-06-09T00:00:00.000+09:00">2023-06-09T00:00:00.000+09:00</time></span></div><style data-emotion="css 1kac5rv">.css-1kac5rv{padding-bottom:4rem;}.css-1kac5rv.markdown-body menu,.css-1kac5rv.markdown-body ol,.css-1kac5rv.markdown-body ul{list-style:revert;}</style><style data-emotion="css 76vy4">.css-76vy4{padding-bottom:4rem;}.css-76vy4.markdown-body menu,.css-76vy4.markdown-body ol,.css-76vy4.markdown-body ul{list-style:revert;}</style><div class="markdown-body MuiBox-root css-76vy4"><h3 id="error-message">Error Message</h3>
<pre><code class="hljs language-jsx"><span class="hljs-title class_">Error</span>: <span class="hljs-title class_">Text</span> content does not match server-rendered <span class="hljs-variable constant_">HTML</span>.
<span class="hljs-title class_">Warning</span>: <span class="hljs-title class_">Text</span> content did not match. <span class="hljs-title class_">Server</span>: <span class="hljs-string">"5/16/2023"</span> <span class="hljs-title class_">Client</span>: <span class="hljs-string">"2023. 5. 16."</span>
<span class="hljs-title class_">See</span> more info <span class="hljs-attr">here</span>: <span class="hljs-attr">https</span>:<span class="hljs-comment">//nextjs.org/docs/messages/react-hydration-error</span>
</code></pre><h3 id="context">Context</h3>
<p>Next.js 13 버전 작업 도중, 서버 사이드에서 받아온 날짜 데이터를 클라이언트 사이드에서 변환하여 렌더링했을 때 오류가 발생했다. </p>
<pre><code class="hljs language-python"><span class="hljs-string">"use client"</span>;

// article props 는 서버 사이드에서 받아옴
const ArticleTemplate: React.FC&lt;ArticleTemplateProps&gt; = ({ article }) =&gt; {
    const localizedDate = new Date(date).toLocaleDateString();
    ...
    <span class="hljs-keyword">return</span> (
        &lt;time dateTime={localizedDate}&gt;
            {localizedDate}
        &lt;/time&gt;
    )
}
</code></pre><h3 id="solution">Solution</h3>
<p>우선 위 오류 메세지에 나온 참고 링크를 살펴보면 원인을 설명해주고 있다.</p>
<blockquote>
<p>While rendering your application, there was a difference between the React tree that was pre-rendered (SSR/SSG) and the React tree that rendered during the first render in the Browser. The first render is called Hydration which is a&nbsp;<a href="https://react.dev/reference/react-dom/hydrate">feature of React</a>.</p>
<p>This can cause the React tree to be out of sync with the DOM and result in unexpected content/attributes being present.</p>
</blockquote>
<p>SSR/SSG 를 통해 pre-render 되는 리액트 트리와 브라우저 단에서 render 되는 리액트 트리가 서로 다르기 때문에 발생하는 문제이고 이 과정은 리액트 기능 중 하나인 ‘Hydration’ 과 관련이 있다고 한다. </p>
<p><strong>Hydration 이란?</strong></p>
<p>Hydration 의 개념을 이해하기 위해서는 CSR 과 SSR의 대표 특징을 먼저 익혀두면 좋다. 이를 Time to Interact 와 Time to View 로 간단히 설명해보자면 다음과 같다. </p>
<ul>
<li>Time to View (TTV): 사용자가 웹사이트를 보기까지 걸리는 시간</li>
<li>Time to interact (TTI): 사용자가 웹에서 클릭 이벤트 같은 상호작용이 가능하게 되는데 걸리는 시간</li>
</ul>
<p><strong>1) CSR</strong></p>
<p><img alt="CSR" src="https://github.com/Rory0304/rory-public-docs/blob/main/rory-dev/articles/react-hydration-error/csr.png?raw=true"></p>
<ul>
<li>유저가 웹 사이트를 방문(Request)하면, 브라우저는 최소한의 index.html 파일과 내부의 JS 번들(Response)을 다운 받음.</li>
<li>브라우저는 다운이 완료되면 JS 를 실행하고, API 를 통해 데이터를 패치해서 동적 컨텐츠를 파싱 후 최종 컨텐츠를 보여줌</li>
<li>사용자가 페이지 이동시, 다시 서버에 request 를 보내지 않고 초기에 받은 JS 파일을 통해 렌더링함</li>
<li>Time to View === Time to Interact</li>
</ul>
<p><strong>2) SSR</strong></p>
<p><img alt="SSR" src="https://github.com/Rory0304/rory-public-docs/blob/main/rory-dev/articles/react-hydration-error/ssr.png?raw=true"></p>
<ul>
<li>유저가 웹 사이트를 방문 (Request) 하면, 서버는 콘텐츠가 렌더된 초기 HTML 파일을 준비함</li>
<li>초기 HTML 파일은 JS 이벤트 같은 추가 렌더링 작업을 위해 브라우저에 보내짐. 이때 유저는 해당 브라우저를 볼 수는 있지만 상호작용을 할 수는 없음 (Response, Time to View)</li>
<li>브라우저는 해당 HTML 파일을 다운 받아서, 인터렉션이 가능하도록 작업을 진행 후, 최종 페이지를 유저에게 전달함 (Time to Interact)</li>
</ul>
<p><strong>3) 정리</strong></p>
<p>React 는 콘텐츠가 없는 HTML Document 파일과 JS 번들 파일을 서버로부터 다운 받은 후, 클라이언트 단에서 자바스크립트 액션을 통해 데이터 패칭 및 Root DOM 요소를 찾아 React 엘리먼트를 하위로 주입하는 과정을 거쳐 웹을 구성한다.</p>
<p><img alt="Next.js 로 만들어진 웹 접속 시, 네트워크 상태 (HTML Document 를 다운 받은 후, script로 DOM 요소를 찾아가며 코드 매칭되는 모습)" src="https://github.com/Rory0304/rory-public-docs/blob/main/rory-dev/articles/react-hydration-error/next-network.png?raw=true"></p>
<p>Next.js 로 만들어진 웹 접속 시, 네트워크 상태 (HTML Document 를 다운 받은 후, script로 DOM 요소를 찾아가며 코드 매칭되는 모습)</p>
<p>Next.js 를 사용할 경우, 서버 사이드에서 data fetch 와 더불어, 콘텐츠가 구성된 초기 웹 페이지를 렌더링하여 클라이언트에게 전송한다. 이때 초기 웹 페이지는 자바스크립트 액션이 모두 빠져있는 HTML 형태이고, 클라이언트 단에서 자바스크립트 코드 파일들이 HTML DOM 요소를 찾아가며 매칭이 이루어진다. 이와 같이 서로 매칭이 이루어지는 과정을 React 에서는 Hydration 이라고 한다. </p>
<p><img alt="hydratino-logic" src="https://github.com/Rory0304/rory-public-docs/blob/main/rory-dev/articles/react-hydration-error/hydration-logic.png?raw=true"></p>
<p>더 자세한 내용은 아래 링크를 참고하면 좋다. 상당히 자세하게 설명이 되어 있어서 Hydration이 작동하는 방식을 잘 이해할 수 있다. </p>
<ul>
<li>Next.js 의 Hydration 이란? : <a href="https://helloinyong.tistory.com/315">https://helloinyong.tistory.com/315</a></li>
<li>React hydration 관련 코드 : <a href="https://react.dev/reference/react-dom/client/hydrateRoot">https://react.dev/reference/react-dom/client/hydrateRoot</a></li>
</ul>
<p>Hydration 과정에서 pre-render 된 결과와 브라우저 단에서 render 되는 결과의 차이 문제의 해결 방법은 아래와 같다. </p>
<ol>
<li>서버 사이드와 클라이언트 사이드에서 state가 달라지는 경우, useEffect 내부에서 관리한다.</li>
</ol>
<ul>
<li>문제가 되는 코드</li>
</ul>
<pre><code class="hljs language-tsx"><span class="hljs-keyword">function</span> <span class="hljs-title function_">MyComponent</span>(<span class="hljs-params"></span>) {
  <span class="hljs-comment">// This condition depends on `window`. During the first render of the browser the `color` variable will be different</span>
  <span class="hljs-keyword">const</span> color = <span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">window</span> !== <span class="hljs-string">'undefined'</span> ? <span class="hljs-string">'red'</span> : <span class="hljs-string">'blue'</span>
  <span class="hljs-comment">// As color is passed as a prop there is a mismatch between what was rendered server-side vs what was rendered in the first render</span>
  <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">title</span> ${<span class="hljs-attr">color</span>}`}&gt;</span>Hello World!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>
}
</code></pre><p>서버 사이드에서는 window 객체가 없기 때문에 color 초기 변수가 ‘red’ 로 정의되지만, 브라우저단에서는 ‘blue’ 이다. 서버 사이드와 브라우저에서 초기 렌더 결과, color 변수의 상태가 각각 다르기 때문에 문제가 발생한다. </p>
<ul>
<li>해결 방법</li>
</ul>
<pre><code class="hljs language-tsx"><span class="hljs-comment">// In order to prevent the first render from being different you can use `useEffect` which is only executed in the browser and is executed during hydration</span>
<span class="hljs-keyword">import</span> { useEffect, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">MyComponent</span>(<span class="hljs-params"></span>) {
  <span class="hljs-comment">// The default value is 'blue', it will be used during pre-rendering and the first render in the browser (hydration)</span>
  <span class="hljs-keyword">const</span> [color, setColor] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">'blue'</span>)
  <span class="hljs-comment">// During hydration `useEffect` is called. `window` is available in `useEffect`. In this case because we know we're in the browser checking for window is not needed. If you need to read something from window that is fine.</span>
  <span class="hljs-comment">// By calling `setColor` in `useEffect` a render is triggered after hydrating, this causes the "browser specific" value to be available. In this case 'red'.</span>
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">setColor</span>(<span class="hljs-string">'red'</span>), [])
  <span class="hljs-comment">// As color is a state passed as a prop there is no mismatch between what was rendered server-side vs what was rendered in the first render. After useEffect runs the color is set to 'red'</span>
  <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">title</span> ${<span class="hljs-attr">color</span>}`}&gt;</span>Hello World!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>
}
</code></pre><p>window 객체 존재 여부에 따른 의존을 없앤다. hydration 과정에서 useEffect가 실행 되면서 변수의 상태를 제어해준다. time to view 에서는 ‘blue’ 로 정의되어 있으나, time to interact 에서는 ‘red’ 로 상태가 변화하는 방식으로 초기 state 를 정의해줄 수 있다. </p>
<ol start="2">
<li>HTML 을 적절히 사용한다.</li>
</ol>
<ul>
<li>문제가 되는 코드</li>
</ul>
<pre><code class="hljs language-tsx">
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">IncorrectComponent</span> = (<span class="hljs-params"></span>) =&gt; {
  <span class="hljs-keyword">return</span> (
    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        This is not correct and should never be done because the p tag has been
        abused
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Image</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/vercel.svg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">""</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"30"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"30"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>
  )
}
</code></pre><p>p 태그 내부에 div 태그를 사용하여 문제가 발생한다.</p>
<blockquote>
<p>The </p><div> tag can NOT be inside&nbsp;<strong><a href="https://www.w3docs.com/learn-html/html-p-tag.html"></a></strong><p><strong><a href="https://www.w3docs.com/learn-html/html-p-tag.html"></a></strong>&nbsp;tag, because the paragraph will be broken at the point, where the </p><div> tag is entered.
출처: <a href="https://www.w3docs.com/learn-html/html-div-tag.html">https://www.w3docs.com/learn-html/html-div-tag.html</a><p></p>
</div></div></blockquote>
<ul>
<li>해결 방법</li>
</ul>
<pre><code class="hljs language-tsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">CorrectComponent</span> = (<span class="hljs-params"></span>) =&gt; {
  <span class="hljs-keyword">return</span> (
    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        This is correct and should work because a div is really good for this
        task.
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Image</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/vercel.svg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">""</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"30"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"30"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}
</code></pre><p>HTML 태그를 적절하게 사용해준다. </p>
<ol start="3">
<li><em>suppressHydrationWarning 을 설정해준다.</em></li>
</ol>
<p>이 방법은 timestamp 와 같이 렌더 트리 간의 exact match 를 보장해주지 못할 경우, warning 을 띄워주지 않는 방법이다. 이 방법은 성능상의 이슈가 있을 수 있기 때문에 남용하지 않는 것이 좋다.</p>
<blockquote>
<p>If you use <a href="https://react.dev/reference/react-dom/server">server rendering,</a> normally there is a warning when the server and the client render different content. In some rare cases (like timestamps), it is very hard or impossible to guarantee an exact match. If you set <code>suppressHydrationWarning</code> to <code>true</code>, React will not warn you about mismatches in the attributes and the content of that element. It only works one level deep, and is intended to be used as an escape hatch. Don’t overuse it.
출처: <a href="https://ko.legacy.reactjs.org/docs/dom-elements.html#suppresshydrationwarning">https://ko.legacy.reactjs.org/docs/dom-elements.html#suppresshydrationwarning</a></p>
</blockquote>
<h2 id="참고-자료">참고 자료</h2>
<p><strong>CSR 과 SSR 차이</strong></p>
<ul>
<li><a href="https://ajdkfl6445.gitbook.io/study/web/csr-vs-ssr-vs-ssg">https://ajdkfl6445.gitbook.io/study/web/csr-vs-ssr-vs-ssg</a></li>
<li><a href="https://velog.io/@juurom/TIL-react-hydration-error-%EC%9B%90%EC%9D%B8-%EB%B0%8F-%ED%95%B4%EA%B2%B0%EB%B0%A9%EB%B2%95-feat.-react-calendar">https://velog.io/@juurom/TIL-react-hydration-error-원인-및-해결방법-feat.-react-calendar</a></li>
</ul>
<p><strong>Hydration 개념</strong></p>
<ul>
<li><a href="https://aboutmonica.com/blog/server-side-rendering-react-hydration-best-practices/#summary">https://aboutmonica.com/blog/server-side-rendering-react-hydration-best-practices/#summary</a></li>
<li><a href="https://velog.io/@huurray/React-Hydration-%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC">https://velog.io/@huurray/React-Hydration-에-대하여</a></li>
<li><a href="https://helloinyong.tistory.com/315">https://helloinyong.tistory.com/315</a></li>
<li><a href="https://velog.io/@hyemin916/%EB%B2%88%EC%97%AD-%EB%A6%AC%EC%95%A1%ED%8A%B8-%EC%95%B1SSR%EC%9D%98-Hydration-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0">https://velog.io/@hyemin916/번역-리액트-앱SSR의-Hydration-이해하기</a></li>
</ul>
</div><style data-emotion="css 39bbo6">.css-39bbo6{margin:0;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;border-width:0;border-style:solid;border-color:rgba(0, 0, 0, 0.12);border-bottom-width:thin;}</style><hr class="MuiDivider-root MuiDivider-fullWidth css-39bbo6"/><style data-emotion="css 178yklu">.css-178yklu{margin-top:24px;}</style><div class="MuiBox-root css-178yklu"><style data-emotion="css 1olvnnf">.css-1olvnnf{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:1.25rem;line-height:1.6;letter-spacing:0.0075em;font-weight:700;margin-bottom:8px;}</style><h6 class="MuiTypography-root MuiTypography-h6 css-1olvnnf">글쓴이</h6><style data-emotion="css 12199pk">.css-12199pk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-column-gap:16px;column-gap:16px;}</style><div class="MuiStack-root css-12199pk"><style data-emotion="css k5a2ak">.css-k5a2ak{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;width:40px;height:40px;font-family:"Roboto","Helvetica","Arial",sans-serif;font-size:1.25rem;line-height:1;border-radius:50%;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:56px;height:56px;}</style><div class="MuiAvatar-root MuiAvatar-circular css-k5a2ak"><style data-emotion="css 1hy9t21">.css-1hy9t21{width:100%;height:100%;text-align:center;object-fit:cover;color:transparent;text-indent:10000px;}</style><img alt="Rory (로리)" src="/profile-image.png" class="MuiAvatar-img css-1hy9t21"/></div><div><style data-emotion="css 1x9q0pr">.css-1x9q0pr{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;margin-bottom:4px;font-weight:700;}</style><p class="MuiTypography-root MuiTypography-body1 css-1x9q0pr">Rory (로리)</p><style data-emotion="css 5ax1kt">.css-5ax1kt{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:8px;}</style><div class="MuiStack-root css-5ax1kt"><a href="mailto: mitty0304@naver.com"><style data-emotion="css 1810fj2">.css-1810fj2{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:coral;font-weight:700;-webkit-transition:cubic-bezier(.4,0,.2,1) 0.15s;transition:cubic-bezier(.4,0,.2,1) 0.15s;}.css-1810fj2:hover{box-shadow:0px 2px 0px 0px coral;}</style><p class="MuiTypography-root MuiTypography-body1 css-1810fj2">Email</p></a><a href="https://www.linkedin.com/in/eunsoosa/"><p class="MuiTypography-root MuiTypography-body1 css-1810fj2">LinkedIn</p></a><a href="https://github.com/Rory0304"><p class="MuiTypography-root MuiTypography-body1 css-1810fj2">GitHub</p></a></div></div></div></div></div><style data-emotion="css s77gdf">.css-s77gdf{padding-top:80px;text-align:center;}</style><div class="MuiBox-root css-s77gdf"><a href="/"><style data-emotion="css 1xdd6dg">.css-1xdd6dg{font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.9375rem;line-height:1.75;letter-spacing:0.02857em;text-transform:uppercase;min-width:64px;padding:8px 22px;border-radius:4px;-webkit-transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:#fff;background-color:#FF7F50;box-shadow:0px 3px 1px -2px rgba(0,0,0,0.2),0px 2px 2px 0px rgba(0,0,0,0.14),0px 1px 5px 0px rgba(0,0,0,0.12);box-shadow:none;width:200px;background-color:#eeeeee;color:GrayText;}.css-1xdd6dg:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#FF7F50;box-shadow:0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);}@media (hover: none){.css-1xdd6dg:hover{background-color:#FF7F50;}}.css-1xdd6dg:active{box-shadow:0px 5px 5px -3px rgba(0,0,0,0.2),0px 8px 10px 1px rgba(0,0,0,0.14),0px 3px 14px 2px rgba(0,0,0,0.12);}.css-1xdd6dg.Mui-focusVisible{box-shadow:0px 3px 5px -1px rgba(0,0,0,0.2),0px 6px 10px 0px rgba(0,0,0,0.14),0px 1px 18px 0px rgba(0,0,0,0.12);}.css-1xdd6dg.Mui-disabled{color:rgba(0, 0, 0, 0.26);box-shadow:none;background-color:rgba(0, 0, 0, 0.12);}.css-1xdd6dg:hover{box-shadow:none;}.css-1xdd6dg.Mui-focusVisible{box-shadow:none;}.css-1xdd6dg:active{box-shadow:none;}.css-1xdd6dg.Mui-disabled{box-shadow:none;}.css-1xdd6dg:hover{background-color:#e0e0e0;}</style><style data-emotion="css 1k4qxhj">.css-1k4qxhj{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.9375rem;line-height:1.75;letter-spacing:0.02857em;text-transform:uppercase;min-width:64px;padding:8px 22px;border-radius:4px;-webkit-transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:#fff;background-color:#FF7F50;box-shadow:0px 3px 1px -2px rgba(0,0,0,0.2),0px 2px 2px 0px rgba(0,0,0,0.14),0px 1px 5px 0px rgba(0,0,0,0.12);box-shadow:none;width:200px;background-color:#eeeeee;color:GrayText;}.css-1k4qxhj::-moz-focus-inner{border-style:none;}.css-1k4qxhj.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-1k4qxhj{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-1k4qxhj:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#FF7F50;box-shadow:0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);}@media (hover: none){.css-1k4qxhj:hover{background-color:#FF7F50;}}.css-1k4qxhj:active{box-shadow:0px 5px 5px -3px rgba(0,0,0,0.2),0px 8px 10px 1px rgba(0,0,0,0.14),0px 3px 14px 2px rgba(0,0,0,0.12);}.css-1k4qxhj.Mui-focusVisible{box-shadow:0px 3px 5px -1px rgba(0,0,0,0.2),0px 6px 10px 0px rgba(0,0,0,0.14),0px 1px 18px 0px rgba(0,0,0,0.12);}.css-1k4qxhj.Mui-disabled{color:rgba(0, 0, 0, 0.26);box-shadow:none;background-color:rgba(0, 0, 0, 0.12);}.css-1k4qxhj:hover{box-shadow:none;}.css-1k4qxhj.Mui-focusVisible{box-shadow:none;}.css-1k4qxhj:active{box-shadow:none;}.css-1k4qxhj.Mui-disabled{box-shadow:none;}.css-1k4qxhj:hover{background-color:#e0e0e0;}</style><button class="MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeLarge MuiButton-containedSizeLarge MuiButton-disableElevation MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeLarge MuiButton-containedSizeLarge MuiButton-disableElevation css-1k4qxhj" tabindex="0" type="button">목록으로</button></a></div></article><style data-emotion="css nmipge">.css-nmipge{margin-top:6rem;}.css-nmipge .utterances{max-width:100%;}</style><section class="article-comment css-nmipge"></section></div></main><footer><style data-emotion="css 1pirdp0">.css-1pirdp0{background-color:whitesmoke;padding-left:24px;padding-right:24px;padding-top:40px;padding-bottom:40px;}</style><div class="MuiBox-root css-1pirdp0"><style data-emotion="css 1c0cfyw">.css-1c0cfyw{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;}@media (min-width:600px){.css-1c0cfyw{padding-left:24px;padding-right:24px;}}@media (min-width:900px){.css-1c0cfyw{max-width:900px;}}</style><div class="MuiContainer-root MuiContainer-maxWidthMd css-1c0cfyw"><style data-emotion="css 95g4uk">.css-95g4uk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="MuiStack-root css-95g4uk"><style data-emotion="css 68o8xu">.css-68o8xu{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:0.875rem;line-height:1.43;letter-spacing:0.01071em;}</style><p class="MuiTypography-root MuiTypography-body2 css-68o8xu">© 2023 Rory. All rights reserved.</p><a href="/rss.xml"><style data-emotion="css vubbuv">.css-vubbuv{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="RssFeedIcon"><circle cx="6.18" cy="17.82" r="2.18"></circle><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"></path></svg></a></div></div></div></footer><script src="/_next/static/chunks/webpack-8cdcea110b0f8206.js" async=""></script><script src="/_next/static/chunks/2443530c-30b88932146dcfcd.js" async=""></script><script src="/_next/static/chunks/139-357fbf7134fa8a25.js" async=""></script><script src="/_next/static/chunks/main-app-4af668d729daad50.js" async=""></script></body></html><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"0:\"$L1\"\n"])</script><script>self.__next_f.push([1,"2:HL[\"/_next/static/css/b761462680944f45.css\",{\"as\":\"style\"}]\n"])</script><script>self.__next_f.push([1,"3:I{\"id\":\"7858\",\"chunks\":[\"272:static/chunks/webpack-8cdcea110b0f8206.js\",\"667:static/chunks/2443530c-30b88932146dcfcd.js\",\"139:static/chunks/139-357fbf7134fa8a25.js\"],\"name\":\"\",\"async\":false}\n5:I{\"id\":\"3055\",\"chunks\":[\"272:static/chunks/webpack-8cdcea110b0f8206.js\",\"667:static/chunks/2443530c-30b88932146dcfcd.js\",\"139:static/chunks/139-357fbf7134fa8a25.js\"],\"name\":\"\",\"async\":false}\n6:I{\"id\":\"770\",\"chunks\":[\"486:static/chunks/486-e422a5b587893871.js\",\"582:static/chunks/582-7b6051b4b4b8536c.js\",\"509:static/c"])</script><script>self.__next_f.push([1,"hunks/509-5ff123a447c14d07.js\",\"185:static/chunks/app/layout-fa644f3a7791e82e.js\"],\"name\":\"\",\"async\":false}\n7:I{\"id\":\"6141\",\"chunks\":[\"486:static/chunks/486-e422a5b587893871.js\",\"582:static/chunks/582-7b6051b4b4b8536c.js\",\"509:static/chunks/509-5ff123a447c14d07.js\",\"185:static/chunks/app/layout-fa644f3a7791e82e.js\"],\"name\":\"\",\"async\":false}\n8:I{\"id\":\"792\",\"chunks\":[\"486:static/chunks/486-e422a5b587893871.js\",\"582:static/chunks/582-7b6051b4b4b8536c.js\",\"112:static/chunks/112-28b6a9566eb21289.js\",\"331:static/"])</script><script>self.__next_f.push([1,"chunks/331-56845378377ebd10.js\",\"63:static/chunks/63-3a460450b358110f.js\",\"83:static/chunks/app/articles/[slug]/page-4837f39ac9caf4e8.js\"],\"name\":\"\",\"async\":false}\n9:I{\"id\":\"6606\",\"chunks\":[\"486:static/chunks/486-e422a5b587893871.js\",\"582:static/chunks/582-7b6051b4b4b8536c.js\",\"112:static/chunks/112-28b6a9566eb21289.js\",\"331:static/chunks/331-56845378377ebd10.js\",\"63:static/chunks/63-3a460450b358110f.js\",\"83:static/chunks/app/articles/[slug]/page-4837f39ac9caf4e8.js\"],\"name\":\"\",\"async\":false}\na:I{\"id\":\"1408"])</script><script>self.__next_f.push([1,"\",\"chunks\":[\"486:static/chunks/486-e422a5b587893871.js\",\"582:static/chunks/582-7b6051b4b4b8536c.js\",\"112:static/chunks/112-28b6a9566eb21289.js\",\"331:static/chunks/331-56845378377ebd10.js\",\"63:static/chunks/63-3a460450b358110f.js\",\"83:static/chunks/app/articles/[slug]/page-4837f39ac9caf4e8.js\"],\"name\":\"\",\"async\":false}\nb:I{\"id\":\"9544\",\"chunks\":[\"272:static/chunks/webpack-8cdcea110b0f8206.js\",\"667:static/chunks/2443530c-30b88932146dcfcd.js\",\"139:static/chunks/139-357fbf7134fa8a25.js\"],\"name\":\"\",\"async\":false}"])</script><script>self.__next_f.push([1,"\nc:I{\"id\":\"99\",\"chunks\":[\"272:static/chunks/webpack-8cdcea110b0f8206.js\",\"667:static/chunks/2443530c-30b88932146dcfcd.js\",\"139:static/chunks/139-357fbf7134fa8a25.js\"],\"name\":\"\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"1:[[],[\"$\",\"$L3\",null,{\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/articles/react-hydration-error\",\"initialTree\":[\"\",{\"children\":[\"articles\",{\"children\":[[\"slug\",\"react-hydration-error\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"react-hydration-error\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[\"$L4\",null],\"globalErrorComponent\":\"$5\",\"notFound\":[\"$\",\"html\",null,{\"lang\":\"ko\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"as\":\"style\",\"crossOrigin\":\"\",\"href\":\"https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.6/dist/web/static/pretendard.css\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.ico\"}]]}],[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$L7\",null,{\"children\":[\"$\",\"body\",null,{\"children\":[[\"$\",\"$L8\",null,{}],[\"$\",\"$L9\",null,{\"children\":[\"$undefined\",[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]]}],[\"$\",\"$La\",null,{}]]}]}]}]]}],\"asNotFound\":false,\"children\":[[\"$\",\"html\",null,{\"lang\":\"ko\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"as\":\"style\",\"crossOrigin\":\"\",\"href\":\"https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.6/dist/web/static/pretendard.css\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.ico\"}]]}],[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$L7\",null,{\"children\":[\"$\",\"body\",null,{\"children\":[[\"$\",\"$L8\",null,{}],[\"$\",\"$L9\",null,{\"children\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"childProp\":{\"current\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"articles\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"childProp\":{\"current\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"articles\",\"children\",[\"slug\",\"react-hydration-error\",\"d\"],\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"childProp\":{\"current\":[\"$Ld\",null],\"segment\":\"__PAGE__?{\\\"slug\\\":\\\"react-hydration-error\\\"}\"},\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/b761462680944f45.css\",\"precedence\":\"next\"}]]}],\"segment\":[\"slug\",\"react-hydration-error\",\"d\"]},\"styles\":[]}],\"segment\":\"articles\"},\"styles\":[]}]}],[\"$\",\"$La\",null,{}]]}]}]}]]}],null]}]]\n"])</script><script>self.__next_f.push([1,"4:[[[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}],null,null,null,null,null,null,null,null,null,null,[\"$\",\"meta\",null,{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],null,null,null,null,null,null,null,null,null,null,[]],[null,null,null,null],null,null,[null,null,null,null,null],null,null,null,null,null]\n"])</script><script>self.__next_f.push([1,"e:I{\"id\":\"809\",\"chunks\":[\"486:static/chunks/486-e422a5b587893871.js\",\"582:static/chunks/582-7b6051b4b4b8536c.js\",\"112:static/chunks/112-28b6a9566eb21289.js\",\"331:static/chunks/331-56845378377ebd10.js\",\"63:static/chunks/63-3a460450b358110f.js\",\"83:static/chunks/app/articles/[slug]/page-4837f39ac9caf4e8.js\"],\"name\":\"\",\"async\":false}\nf:I{\"id\":\"9901\",\"chunks\":[\"486:static/chunks/486-e422a5b587893871.js\",\"582:static/chunks/582-7b6051b4b4b8536c.js\",\"112:static/chunks/112-28b6a9566eb21289.js\",\"331:static/chunks/33"])</script><script>self.__next_f.push([1,"1-56845378377ebd10.js\",\"63:static/chunks/63-3a460450b358110f.js\",\"83:static/chunks/app/articles/[slug]/page-4837f39ac9caf4e8.js\"],\"name\":\"\",\"async\":false}\n10:I{\"id\":\"5771\",\"chunks\":[\"486:static/chunks/486-e422a5b587893871.js\",\"582:static/chunks/582-7b6051b4b4b8536c.js\",\"112:static/chunks/112-28b6a9566eb21289.js\",\"331:static/chunks/331-56845378377ebd10.js\",\"63:static/chunks/63-3a460450b358110f.js\",\"83:static/chunks/app/articles/[slug]/page-4837f39ac9caf4e8.js\"],\"name\":\"\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"$Le\",null,{\"title\":\"Articles | rory dev\",\"description\":\" Mainly handle development-related knowledge and project retrospectives.\"}],[\"$\",\"$Lf\",null,{\"article\":{\"__typename\":\"Article\",\"sys\":{\"__typename\":\"Sys\",\"id\":\"uZHtg9NaaldVQ23t8iWZc\"},\"title\":\"Next 13 react hydration error\",\"slug\":\"react-hydration-error\",\"content\":\"\u003ch3 id=\\\"error-message\\\"\u003eError Message\u003c/h3\u003e\\n\u003cpre\u003e\u003ccode class=\\\"hljs language-jsx\\\"\u003e\u003cspan class=\\\"hljs-title class_\\\"\u003eError\u003c/span\u003e: \u003cspan class=\\\"hljs-title class_\\\"\u003eText\u003c/span\u003e content does not match server-rendered \u003cspan class=\\\"hljs-variable constant_\\\"\u003eHTML\u003c/span\u003e.\\n\u003cspan class=\\\"hljs-title class_\\\"\u003eWarning\u003c/span\u003e: \u003cspan class=\\\"hljs-title class_\\\"\u003eText\u003c/span\u003e content did not match. \u003cspan class=\\\"hljs-title class_\\\"\u003eServer\u003c/span\u003e: \u003cspan class=\\\"hljs-string\\\"\u003e\\\"5/16/2023\\\"\u003c/span\u003e \u003cspan class=\\\"hljs-title class_\\\"\u003eClient\u003c/span\u003e: \u003cspan class=\\\"hljs-string\\\"\u003e\\\"2023. 5. 16.\\\"\u003c/span\u003e\\n\u003cspan class=\\\"hljs-title class_\\\"\u003eSee\u003c/span\u003e more info \u003cspan class=\\\"hljs-attr\\\"\u003ehere\u003c/span\u003e: \u003cspan class=\\\"hljs-attr\\\"\u003ehttps\u003c/span\u003e:\u003cspan class=\\\"hljs-comment\\\"\u003e//nextjs.org/docs/messages/react-hydration-error\u003c/span\u003e\\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\\\"context\\\"\u003eContext\u003c/h3\u003e\\n\u003cp\u003eNext.js 13 버전 작업 도중, 서버 사이드에서 받아온 날짜 데이터를 클라이언트 사이드에서 변환하여 렌더링했을 때 오류가 발생했다. \u003c/p\u003e\\n\u003cpre\u003e\u003ccode class=\\\"hljs language-python\\\"\u003e\u003cspan class=\\\"hljs-string\\\"\u003e\\\"use client\\\"\u003c/span\u003e;\\n\\n// article props 는 서버 사이드에서 받아옴\\nconst ArticleTemplate: React.FC\u0026lt;ArticleTemplateProps\u0026gt; = ({ article }) =\u0026gt; {\\n    const localizedDate = new Date(date).toLocaleDateString();\\n    ...\\n    \u003cspan class=\\\"hljs-keyword\\\"\u003ereturn\u003c/span\u003e (\\n        \u0026lt;time dateTime={localizedDate}\u0026gt;\\n            {localizedDate}\\n        \u0026lt;/time\u0026gt;\\n    )\\n}\\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\\\"solution\\\"\u003eSolution\u003c/h3\u003e\\n\u003cp\u003e우선 위 오류 메세지에 나온 참고 링크를 살펴보면 원인을 설명해주고 있다.\u003c/p\u003e\\n\u003cblockquote\u003e\\n\u003cp\u003eWhile rendering your application, there was a difference between the React tree that was pre-rendered (SSR/SSG) and the React tree that rendered during the first render in the Browser. The first render is called Hydration which is a\u0026nbsp;\u003ca href=\\\"https://react.dev/reference/react-dom/hydrate\\\"\u003efeature of React\u003c/a\u003e.\u003c/p\u003e\\n\u003cp\u003eThis can cause the React tree to be out of sync with the DOM and result in unexpected content/attributes being present.\u003c/p\u003e\\n\u003c/blockquote\u003e\\n\u003cp\u003eSSR/SSG 를 통해 pre-render 되는 리액트 트리와 브라우저 단에서 render 되는 리액트 트리가 서로 다르기 때문에 발생하는 문제이고 이 과정은 리액트 기능 중 하나인 ‘Hydration’ 과 관련이 있다고 한다. \u003c/p\u003e\\n\u003cp\u003e\u003cstrong\u003eHydration 이란?\u003c/strong\u003e\u003c/p\u003e\\n\u003cp\u003eHydration 의 개념을 이해하기 위해서는 CSR 과 SSR의 대표 특징을 먼저 익혀두면 좋다. 이를 Time to Interact 와 Time to View 로 간단히 설명해보자면 다음과 같다. \u003c/p\u003e\\n\u003cul\u003e\\n\u003cli\u003eTime to View (TTV): 사용자가 웹사이트를 보기까지 걸리는 시간\u003c/li\u003e\\n\u003cli\u003eTime to interact (TTI): 사용자가 웹에서 클릭 이벤트 같은 상호작용이 가능하게 되는데 걸리는 시간\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003cp\u003e\u003cstrong\u003e1) CSR\u003c/strong\u003e\u003c/p\u003e\\n\u003cp\u003e\u003cimg alt=\\\"CSR\\\" src=\\\"https://github.com/Rory0304/rory-public-docs/blob/main/rory-dev/articles/react-hydration-error/csr.png?raw=true\\\"\u003e\u003c/p\u003e\\n\u003cul\u003e\\n\u003cli\u003e유저가 웹 사이트를 방문(Request)하면, 브라우저는 최소한의 index.html 파일과 내부의 JS 번들(Response)을 다운 받음.\u003c/li\u003e\\n\u003cli\u003e브라우저는 다운이 완료되면 JS 를 실행하고, API 를 통해 데이터를 패치해서 동적 컨텐츠를 파싱 후 최종 컨텐츠를 보여줌\u003c/li\u003e\\n\u003cli\u003e사용자가 페이지 이동시, 다시 서버에 request 를 보내지 않고 초기에 받은 JS 파일을 통해 렌더링함\u003c/li\u003e\\n\u003cli\u003eTime to View === Time to Interact\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003cp\u003e\u003cstrong\u003e2) SSR\u003c/strong\u003e\u003c/p\u003e\\n\u003cp\u003e\u003cimg alt=\\\"SSR\\\" src=\\\"https://github.com/Rory0304/rory-public-docs/blob/main/rory-dev/articles/react-hydration-error/ssr.png?raw=true\\\"\u003e\u003c/p\u003e\\n\u003cul\u003e\\n\u003cli\u003e유저가 웹 사이트를 방문 (Request) 하면, 서버는 콘텐츠가 렌더된 초기 HTML 파일을 준비함\u003c/li\u003e\\n\u003cli\u003e초기 HTML 파일은 JS 이벤트 같은 추가 렌더링 작업을 위해 브라우저에 보내짐. 이때 유저는 해당 브라우저를 볼 수는 있지만 상호작용을 할 수는 없음 (Response, Time to View)\u003c/li\u003e\\n\u003cli\u003e브라우저는 해당 HTML 파일을 다운 받아서, 인터렉션이 가능하도록 작업을 진행 후, 최종 페이지를 유저에게 전달함 (Time to Interact)\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003cp\u003e\u003cstrong\u003e3) 정리\u003c/strong\u003e\u003c/p\u003e\\n\u003cp\u003eReact 는 콘텐츠가 없는 HTML Document 파일과 JS 번들 파일을 서버로부터 다운 받은 후, 클라이언트 단에서 자바스크립트 액션을 통해 데이터 패칭 및 Root DOM 요소를 찾아 React 엘리먼트를 하위로 주입하는 과정을 거쳐 웹을 구성한다.\u003c/p\u003e\\n\u003cp\u003e\u003cimg alt=\\\"Next.js 로 만들어진 웹 접속 시, 네트워크 상태 (HTML Document 를 다운 받은 후, script로 DOM 요소를 찾아가며 코드 매칭되는 모습)\\\" src=\\\"https://github.com/Rory0304/rory-public-docs/blob/main/rory-dev/articles/react-hydration-error/next-network.png?raw=true\\\"\u003e\u003c/p\u003e\\n\u003cp\u003eNext.js 로 만들어진 웹 접속 시, 네트워크 상태 (HTML Document 를 다운 받은 후, script로 DOM 요소를 찾아가며 코드 매칭되는 모습)\u003c/p\u003e\\n\u003cp\u003eNext.js 를 사용할 경우, 서버 사이드에서 data fetch 와 더불어, 콘텐츠가 구성된 초기 웹 페이지를 렌더링하여 클라이언트에게 전송한다. 이때 초기 웹 페이지는 자바스크립트 액션이 모두 빠져있는 HTML 형태이고, 클라이언트 단에서 자바스크립트 코드 파일들이 HTML DOM 요소를 찾아가며 매칭이 이루어진다. 이와 같이 서로 매칭이 이루어지는 과정을 React 에서는 Hydration 이라고 한다. \u003c/p\u003e\\n\u003cp\u003e\u003cimg alt=\\\"hydratino-logic\\\" src=\\\"https://github.com/Rory0304/rory-public-docs/blob/main/rory-dev/articles/react-hydration-error/hydration-logic.png?raw=true\\\"\u003e\u003c/p\u003e\\n\u003cp\u003e더 자세한 내용은 아래 링크를 참고하면 좋다. 상당히 자세하게 설명이 되어 있어서 Hydration이 작동하는 방식을 잘 이해할 수 있다. \u003c/p\u003e\\n\u003cul\u003e\\n\u003cli\u003eNext.js 의 Hydration 이란? : \u003ca href=\\\"https://helloinyong.tistory.com/315\\\"\u003ehttps://helloinyong.tistory.com/315\u003c/a\u003e\u003c/li\u003e\\n\u003cli\u003eReact hydration 관련 코드 : \u003ca href=\\\"https://react.dev/reference/react-dom/client/hydrateRoot\\\"\u003ehttps://react.dev/reference/react-dom/client/hydrateRoot\u003c/a\u003e\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003cp\u003eHydration 과정에서 pre-render 된 결과와 브라우저 단에서 render 되는 결과의 차이 문제의 해결 방법은 아래와 같다. \u003c/p\u003e\\n\u003col\u003e\\n\u003cli\u003e서버 사이드와 클라이언트 사이드에서 state가 달라지는 경우, useEffect 내부에서 관리한다.\u003c/li\u003e\\n\u003c/ol\u003e\\n\u003cul\u003e\\n\u003cli\u003e문제가 되는 코드\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003cpre\u003e\u003ccode class=\\\"hljs language-tsx\\\"\u003e\u003cspan class=\\\"hljs-keyword\\\"\u003efunction\u003c/span\u003e \u003cspan class=\\\"hljs-title function_\\\"\u003eMyComponent\u003c/span\u003e(\u003cspan class=\\\"hljs-params\\\"\u003e\u003c/span\u003e) {\\n  \u003cspan class=\\\"hljs-comment\\\"\u003e// This condition depends on `window`. During the first render of the browser the `color` variable will be different\u003c/span\u003e\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e color = \u003cspan class=\\\"hljs-keyword\\\"\u003etypeof\u003c/span\u003e \u003cspan class=\\\"hljs-variable language_\\\"\u003ewindow\u003c/span\u003e !== \u003cspan class=\\\"hljs-string\\\"\u003e'undefined'\u003c/span\u003e ? \u003cspan class=\\\"hljs-string\\\"\u003e'red'\u003c/span\u003e : \u003cspan class=\\\"hljs-string\\\"\u003e'blue'\u003c/span\u003e\\n  \u003cspan class=\\\"hljs-comment\\\"\u003e// As color is passed as a prop there is a mismatch between what was rendered server-side vs what was rendered in the first render\u003c/span\u003e\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003ereturn\u003c/span\u003e \u003cspan class=\\\"language-xml\\\"\u003e\u003cspan class=\\\"hljs-tag\\\"\u003e\u0026lt;\u003cspan class=\\\"hljs-name\\\"\u003eh1\u003c/span\u003e \u003cspan class=\\\"hljs-attr\\\"\u003eclassName\u003c/span\u003e=\u003cspan class=\\\"hljs-string\\\"\u003e{\u003c/span\u003e`\u003cspan class=\\\"hljs-attr\\\"\u003etitle\u003c/span\u003e ${\u003cspan class=\\\"hljs-attr\\\"\u003ecolor\u003c/span\u003e}`}\u0026gt;\u003c/span\u003eHello World!\u003cspan class=\\\"hljs-tag\\\"\u003e\u0026lt;/\u003cspan class=\\\"hljs-name\\\"\u003eh1\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\\n}\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e서버 사이드에서는 window 객체가 없기 때문에 color 초기 변수가 ‘red’ 로 정의되지만, 브라우저단에서는 ‘blue’ 이다. 서버 사이드와 브라우저에서 초기 렌더 결과, color 변수의 상태가 각각 다르기 때문에 문제가 발생한다. \u003c/p\u003e\\n\u003cul\u003e\\n\u003cli\u003e해결 방법\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003cpre\u003e\u003ccode class=\\\"hljs language-tsx\\\"\u003e\u003cspan class=\\\"hljs-comment\\\"\u003e// In order to prevent the first render from being different you can use `useEffect` which is only executed in the browser and is executed during hydration\u003c/span\u003e\\n\u003cspan class=\\\"hljs-keyword\\\"\u003eimport\u003c/span\u003e { useEffect, useState } \u003cspan class=\\\"hljs-keyword\\\"\u003efrom\u003c/span\u003e \u003cspan class=\\\"hljs-string\\\"\u003e'react'\u003c/span\u003e\\n\u003cspan class=\\\"hljs-keyword\\\"\u003efunction\u003c/span\u003e \u003cspan class=\\\"hljs-title function_\\\"\u003eMyComponent\u003c/span\u003e(\u003cspan class=\\\"hljs-params\\\"\u003e\u003c/span\u003e) {\\n  \u003cspan class=\\\"hljs-comment\\\"\u003e// The default value is 'blue', it will be used during pre-rendering and the first render in the browser (hydration)\u003c/span\u003e\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e [color, setColor] = \u003cspan class=\\\"hljs-title function_\\\"\u003euseState\u003c/span\u003e(\u003cspan class=\\\"hljs-string\\\"\u003e'blue'\u003c/span\u003e)\\n  \u003cspan class=\\\"hljs-comment\\\"\u003e// During hydration `useEffect` is called. `window` is available in `useEffect`. In this case because we know we're in the browser checking for window is not needed. If you need to read something from window that is fine.\u003c/span\u003e\\n  \u003cspan class=\\\"hljs-comment\\\"\u003e// By calling `setColor` in `useEffect` a render is triggered after hydrating, this causes the \\\"browser specific\\\" value to be available. In this case 'red'.\u003c/span\u003e\\n  \u003cspan class=\\\"hljs-title function_\\\"\u003euseEffect\u003c/span\u003e(\u003cspan class=\\\"hljs-function\\\"\u003e() =\u0026gt;\u003c/span\u003e \u003cspan class=\\\"hljs-title function_\\\"\u003esetColor\u003c/span\u003e(\u003cspan class=\\\"hljs-string\\\"\u003e'red'\u003c/span\u003e), [])\\n  \u003cspan class=\\\"hljs-comment\\\"\u003e// As color is a state passed as a prop there is no mismatch between what was rendered server-side vs what was rendered in the first render. After useEffect runs the color is set to 'red'\u003c/span\u003e\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003ereturn\u003c/span\u003e \u003cspan class=\\\"language-xml\\\"\u003e\u003cspan class=\\\"hljs-tag\\\"\u003e\u0026lt;\u003cspan class=\\\"hljs-name\\\"\u003eh1\u003c/span\u003e \u003cspan class=\\\"hljs-attr\\\"\u003eclassName\u003c/span\u003e=\u003cspan class=\\\"hljs-string\\\"\u003e{\u003c/span\u003e`\u003cspan class=\\\"hljs-attr\\\"\u003etitle\u003c/span\u003e ${\u003cspan class=\\\"hljs-attr\\\"\u003ecolor\u003c/span\u003e}`}\u0026gt;\u003c/span\u003eHello World!\u003cspan class=\\\"hljs-tag\\\"\u003e\u0026lt;/\u003cspan class=\\\"hljs-name\\\"\u003eh1\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\\n}\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003ewindow 객체 존재 여부에 따른 의존을 없앤다. hydration 과정에서 useEffect가 실행 되면서 변수의 상태를 제어해준다. time to view 에서는 ‘blue’ 로 정의되어 있으나, time to interact 에서는 ‘red’ 로 상태가 변화하는 방식으로 초기 state 를 정의해줄 수 있다. \u003c/p\u003e\\n\u003col start=\\\"2\\\"\u003e\\n\u003cli\u003eHTML 을 적절히 사용한다.\u003c/li\u003e\\n\u003c/ol\u003e\\n\u003cul\u003e\\n\u003cli\u003e문제가 되는 코드\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003cpre\u003e\u003ccode class=\\\"hljs language-tsx\\\"\u003e\\n\u003cspan class=\\\"hljs-keyword\\\"\u003eexport\u003c/span\u003e \u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e \u003cspan class=\\\"hljs-title function_\\\"\u003eIncorrectComponent\u003c/span\u003e = (\u003cspan class=\\\"hljs-params\\\"\u003e\u003c/span\u003e) =\u0026gt; {\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003ereturn\u003c/span\u003e (\\n    \u003cspan class=\\\"language-xml\\\"\u003e\u003cspan class=\\\"hljs-tag\\\"\u003e\u0026lt;\u003cspan class=\\\"hljs-name\\\"\u003ep\u003c/span\u003e\u0026gt;\u003c/span\u003e\\n      \u003cspan class=\\\"hljs-tag\\\"\u003e\u0026lt;\u003cspan class=\\\"hljs-name\\\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\\n        This is not correct and should never be done because the p tag has been\\n        abused\\n      \u003cspan class=\\\"hljs-tag\\\"\u003e\u0026lt;/\u003cspan class=\\\"hljs-name\\\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\\n      \u003cspan class=\\\"hljs-tag\\\"\u003e\u0026lt;\u003cspan class=\\\"hljs-name\\\"\u003eImage\u003c/span\u003e \u003cspan class=\\\"hljs-attr\\\"\u003esrc\u003c/span\u003e=\u003cspan class=\\\"hljs-string\\\"\u003e\\\"/vercel.svg\\\"\u003c/span\u003e \u003cspan class=\\\"hljs-attr\\\"\u003ealt\u003c/span\u003e=\u003cspan class=\\\"hljs-string\\\"\u003e\\\"\\\"\u003c/span\u003e \u003cspan class=\\\"hljs-attr\\\"\u003ewidth\u003c/span\u003e=\u003cspan class=\\\"hljs-string\\\"\u003e\\\"30\\\"\u003c/span\u003e \u003cspan class=\\\"hljs-attr\\\"\u003eheight\u003c/span\u003e=\u003cspan class=\\\"hljs-string\\\"\u003e\\\"30\\\"\u003c/span\u003e /\u0026gt;\u003c/span\u003e\\n    \u003cspan class=\\\"hljs-tag\\\"\u003e\u0026lt;/\u003cspan class=\\\"hljs-name\\\"\u003ep\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\\n  )\\n}\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003ep 태그 내부에 div 태그를 사용하여 문제가 발생한다.\u003c/p\u003e\\n\u003cblockquote\u003e\\n\u003cp\u003eThe \u003c/p\u003e\u003cdiv\u003e tag can NOT be inside\u0026nbsp;\u003cstrong\u003e\u003ca href=\\\"https://www.w3docs.com/learn-html/html-p-tag.html\\\"\u003e\u003c/a\u003e\u003c/strong\u003e\u003cp\u003e\u003cstrong\u003e\u003ca href=\\\"https://www.w3docs.com/learn-html/html-p-tag.html\\\"\u003e\u003c/a\u003e\u003c/strong\u003e\u0026nbsp;tag, because the paragraph will be broken at the point, where the \u003c/p\u003e\u003cdiv\u003e tag is entered.\\n출처: \u003ca href=\\\"https://www.w3docs.com/learn-html/html-div-tag.html\\\"\u003ehttps://www.w3docs.com/learn-html/html-div-tag.html\u003c/a\u003e\u003cp\u003e\u003c/p\u003e\\n\u003c/div\u003e\u003c/div\u003e\u003c/blockquote\u003e\\n\u003cul\u003e\\n\u003cli\u003e해결 방법\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003cpre\u003e\u003ccode class=\\\"hljs language-tsx\\\"\u003e\u003cspan class=\\\"hljs-keyword\\\"\u003eexport\u003c/span\u003e \u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e \u003cspan class=\\\"hljs-title function_\\\"\u003eCorrectComponent\u003c/span\u003e = (\u003cspan class=\\\"hljs-params\\\"\u003e\u003c/span\u003e) =\u0026gt; {\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003ereturn\u003c/span\u003e (\\n    \u003cspan class=\\\"language-xml\\\"\u003e\u003cspan class=\\\"hljs-tag\\\"\u003e\u0026lt;\u003cspan class=\\\"hljs-name\\\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\\n      \u003cspan class=\\\"hljs-tag\\\"\u003e\u0026lt;\u003cspan class=\\\"hljs-name\\\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\\n        This is correct and should work because a div is really good for this\\n        task.\\n      \u003cspan class=\\\"hljs-tag\\\"\u003e\u0026lt;/\u003cspan class=\\\"hljs-name\\\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\\n      \u003cspan class=\\\"hljs-tag\\\"\u003e\u0026lt;\u003cspan class=\\\"hljs-name\\\"\u003eImage\u003c/span\u003e \u003cspan class=\\\"hljs-attr\\\"\u003esrc\u003c/span\u003e=\u003cspan class=\\\"hljs-string\\\"\u003e\\\"/vercel.svg\\\"\u003c/span\u003e \u003cspan class=\\\"hljs-attr\\\"\u003ealt\u003c/span\u003e=\u003cspan class=\\\"hljs-string\\\"\u003e\\\"\\\"\u003c/span\u003e \u003cspan class=\\\"hljs-attr\\\"\u003ewidth\u003c/span\u003e=\u003cspan class=\\\"hljs-string\\\"\u003e\\\"30\\\"\u003c/span\u003e \u003cspan class=\\\"hljs-attr\\\"\u003eheight\u003c/span\u003e=\u003cspan class=\\\"hljs-string\\\"\u003e\\\"30\\\"\u003c/span\u003e /\u0026gt;\u003c/span\u003e\\n    \u003cspan class=\\\"hljs-tag\\\"\u003e\u0026lt;/\u003cspan class=\\\"hljs-name\\\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\\n  )\\n}\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eHTML 태그를 적절하게 사용해준다. \u003c/p\u003e\\n\u003col start=\\\"3\\\"\u003e\\n\u003cli\u003e\u003cem\u003esuppressHydrationWarning 을 설정해준다.\u003c/em\u003e\u003c/li\u003e\\n\u003c/ol\u003e\\n\u003cp\u003e이 방법은 timestamp 와 같이 렌더 트리 간의 exact match 를 보장해주지 못할 경우, warning 을 띄워주지 않는 방법이다. 이 방법은 성능상의 이슈가 있을 수 있기 때문에 남용하지 않는 것이 좋다.\u003c/p\u003e\\n\u003cblockquote\u003e\\n\u003cp\u003eIf you use \u003ca href=\\\"https://react.dev/reference/react-dom/server\\\"\u003eserver rendering,\u003c/a\u003e normally there is a warning when the server and the client render different content. In some rare cases (like timestamps), it is very hard or impossible to guarantee an exact match. If you set \u003ccode\u003esuppressHydrationWarning\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e, React will not warn you about mismatches in the attributes and the content of that element. It only works one level deep, and is intended to be used as an escape hatch. Don’t overuse it.\\n출처: \u003ca href=\\\"https://ko.legacy.reactjs.org/docs/dom-elements.html#suppresshydrationwarning\\\"\u003ehttps://ko.legacy.reactjs.org/docs/dom-elements.html#suppresshydrationwarning\u003c/a\u003e\u003c/p\u003e\\n\u003c/blockquote\u003e\\n\u003ch2 id=\\\"참고-자료\\\"\u003e참고 자료\u003c/h2\u003e\\n\u003cp\u003e\u003cstrong\u003eCSR 과 SSR 차이\u003c/strong\u003e\u003c/p\u003e\\n\u003cul\u003e\\n\u003cli\u003e\u003ca href=\\\"https://ajdkfl6445.gitbook.io/study/web/csr-vs-ssr-vs-ssg\\\"\u003ehttps://ajdkfl6445.gitbook.io/study/web/csr-vs-ssr-vs-ssg\u003c/a\u003e\u003c/li\u003e\\n\u003cli\u003e\u003ca href=\\\"https://velog.io/@juurom/TIL-react-hydration-error-%EC%9B%90%EC%9D%B8-%EB%B0%8F-%ED%95%B4%EA%B2%B0%EB%B0%A9%EB%B2%95-feat.-react-calendar\\\"\u003ehttps://velog.io/@juurom/TIL-react-hydration-error-원인-및-해결방법-feat.-react-calendar\u003c/a\u003e\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003cp\u003e\u003cstrong\u003eHydration 개념\u003c/strong\u003e\u003c/p\u003e\\n\u003cul\u003e\\n\u003cli\u003e\u003ca href=\\\"https://aboutmonica.com/blog/server-side-rendering-react-hydration-best-practices/#summary\\\"\u003ehttps://aboutmonica.com/blog/server-side-rendering-react-hydration-best-practices/#summary\u003c/a\u003e\u003c/li\u003e\\n\u003cli\u003e\u003ca href=\\\"https://velog.io/@huurray/React-Hydration-%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC\\\"\u003ehttps://velog.io/@huurray/React-Hydration-에-대하여\u003c/a\u003e\u003c/li\u003e\\n\u003cli\u003e\u003ca href=\\\"https://helloinyong.tistory.com/315\\\"\u003ehttps://helloinyong.tistory.com/315\u003c/a\u003e\u003c/li\u003e\\n\u003cli\u003e\u003ca href=\\\"https://velog.io/@hyemin916/%EB%B2%88%EC%97%AD-%EB%A6%AC%EC%95%A1%ED%8A%B8-%EC%95%B1SSR%EC%9D%98-Hydration-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0\\\"\u003ehttps://velog.io/@hyemin916/번역-리액트-앱SSR의-Hydration-이해하기\u003c/a\u003e\u003c/li\u003e\\n\u003c/ul\u003e\\n\",\"category\":\"Troubleshooting\",\"date\":\"2023-06-09T00:00:00.000+09:00\",\"thumbnail\":{\"__typename\":\"Asset\",\"url\":\"https://images.ctfassets.net/98cksird3kze/1aSjwwZ9CchJJCAK8ED6ew/40539531bd28edceb0b5dfe40f9c9c66/pexels-pixabay-327090.jpeg\"}}}],[\"$\",\"$L10\",null,{}]]\n"])</script>